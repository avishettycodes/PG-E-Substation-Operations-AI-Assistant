services:
  # AI-Powered Substation Operations Assistant
  - type: web
    name: pge-substation-ai-assistant
    env: node
    buildCommand: npm install && cd server && npm install
    startCommand: cd server && node --optimize_for_size --max_old_space_size=512 --gc_interval=100 $(which npx) ts-node src/test-web-server.ts
    envVars:
      - key: NODE_ENV
        value: production
      - key: PORT
        value: 4477
      - key: OPENAI_API_KEY
        sync: false
    plan: free
    healthCheckPath: /health 